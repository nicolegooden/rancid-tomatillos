(this["webpackJsonprancid-tomatillos"]=this["webpackJsonprancid-tomatillos"]||[]).push([[0],{24:function(e,t,a){e.exports=a.p+"static/media/tomato.6ec1b1ac.png"},25:function(e,t,a){e.exports=a(43)},30:function(e,t,a){},31:function(e,t,a){},38:function(e,t,a){},39:function(e,t,a){},40:function(e,t,a){},41:function(e,t,a){},42:function(e,t,a){},43:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(20),s=a.n(i),o=a(6),c=(a(30),a(7)),l=a(8),u=a(13),m=a(10),p=a(9),h=a(1),g=a(21),d=function(e){return fetch("https://rancid-tomatillos.herokuapp.com/api/v2//users/".concat(e,"/ratings")).then((function(e){return e.json()})).catch((function(e){return console.log(e)}))},v=function(e){return fetch("http://localhost:3001/api/v1/movies/".concat(e,"/comments")).then((function(e){return e.json()})).catch((function(e){return console.log(e)}))},f=(a(31),function(e){Object(m.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).handleInputChange=function(e){n.setState(Object(g.a)({},e.target.name,e.target.value))},n.handleLogin=function(e){var t,a;e.preventDefault(),""!==n.state.email&&""!==n.state.password?(t=n.state.email,a=n.state.password,fetch("https://rancid-tomatillos.herokuapp.com/api/v2/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:t,password:a})}).then((function(e){return e.json()})).catch((function(e){return console.log(e)}))).then((function(e){return n.props.setUser(e)})).then((function(){return n.setState({error:"Incorrect email or password, please try again."})})):n.setState({error:"Please enter your email and your password."}),n.clearInputs()},n.state={email:"",password:"",error:""},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.props.updateLoginView()}},{key:"clearInputs",value:function(){this.setState({email:"",password:""})}},{key:"render",value:function(){return this.props.user.name?r.a.createElement(h.a,{to:"/"}):r.a.createElement("section",{className:"login-container"},r.a.createElement("form",{className:"login-form"},r.a.createElement("div",{className:"email-input-div"},r.a.createElement("label",{className:"login-label",htmlFor:"user-email"},"Email:"),r.a.createElement("input",{className:"login-input",type:"text",placeholder:"example@email.com",name:"email",value:this.state.email,onChange:this.handleInputChange})),r.a.createElement("div",{className:"password-input-div"},r.a.createElement("label",{className:"login-label",htmlFor:"user-password"},"Password:"),r.a.createElement("input",{className:"login-input",type:"password",placeholder:"enter password",name:"password",value:this.state.password,onChange:this.handleInputChange})),r.a.createElement("button",{className:"login-button",onClick:this.handleLogin},"Login"),r.a.createElement("p",null,this.state.error)))}}]),a}(n.Component)),E=a(17),b=a.n(E),R=a(23),w=(a(38),function(e){Object(m.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).showAllComments=function(){if(n.state.allComments.length)return n.state.allComments.map((function(e){return r.a.createElement("article",{className:"comment-card"},r.a.createElement("p",null,'"',e.comment,'"'),r.a.createElement("p",null," - ",e.author))}))},n.determineSingleMovie=function(e){(function(e){return fetch("https://rancid-tomatillos.herokuapp.com/api/v2/movies/".concat(e)).then((function(e){return e.json()})).catch((function(e){return console.log(e)}))})(e).then((function(e){return n.setState({currentMovie:e.movie})})).then(n.props.retrieveAllRatings()).catch((function(e){return n.setState({error:e})}))},n.getGenres=function(){return n.state.currentMovie.genres.map((function(e){return"".concat(e," ")}))},n.handleChange=function(e){n.setState({commentInput:e.target.value})},n.clearInputs=function(){n.setState({commentInput:""})},n.submitReview=Object(R.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t=n.props.id,a=n.state.commentInput,r=n.props.user.name,fetch("http://localhost:3001/api/v1/movies/".concat(t,"/comments"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({comment:a,author:r})}).then((function(e){return e.json()})).catch((function(e){return console.log(e)}));case 2:v(n.props.id).then((function(e){return n.setState({allComments:e.comments})})).then((function(){return n.clearInputs()}));case 3:case"end":return e.stop()}var t,a,r}),e)}))),n.determineUserRating=function(){if(n.props.findUserRating(n.props.id)>0)return r.a.createElement("p",{className:"user-rating"},"My Rating: ",n.props.findUserRating(n.props.id),"/10")},n.state={currentMovie:{},error:"",commentInput:"",allComments:[]},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.determineSingleMovie(this.props.id),v(this.props.id).then((function(t){t&&e.setState({allComments:t.comments})}))}},{key:"render",value:function(){var e;return e=this.state.currentMovie.overview?r.a.createElement("main",null,r.a.createElement("h2",{className:"show-page-title"},this.props.title),r.a.createElement("section",{className:"show-page-container"},r.a.createElement("article",{className:"show-page-basic-information"},r.a.createElement("img",{className:"show-page-image",alt:"poster for {this.props.title}",src:this.state.currentMovie.backdrop_path}),r.a.createElement("p",{className:"tagline"},this.state.currentMovie.tagline),r.a.createElement("article",{className:"ratings"},r.a.createElement("p",{className:"show-page-average-rating"},"Average Rating: ",Math.floor(this.props.average_rating),"/10"),this.determineUserRating())),r.a.createElement("article",{className:"show-page-additional-information"},r.a.createElement("p",{className:"run-time"},"Runtime: ",this.state.currentMovie.runtime," minutes"),r.a.createElement("p",{className:"genres"},"Genres: ",this.getGenres()),r.a.createElement("p",{className:"overview"},this.state.currentMovie.overview),r.a.createElement("p",{className:"release-date"},"Release Date: ",this.state.currentMovie.release_date))),r.a.createElement("article",{className:"comment-form"},r.a.createElement("label",{htmlFor:"comment-input"},"Write Review: "),r.a.createElement("textarea",{value:this.state.commentInput,onChange:this.handleChange,rows:"5",cols:"25",wrap:"hard",className:"comment-input"}),r.a.createElement("button",{className:"submit-comment-button",onClick:this.submitReview},"Submit")),r.a.createElement("section",{className:"all-comments"},this.showAllComments())):r.a.createElement("h1",null,"Loading your movie"),r.a.createElement("div",null,e)}}]),a}(n.Component)),N=(a(39),a(24)),S=a.n(N);var k=function(e){return r.a.createElement("section",{className:"header"},r.a.createElement("img",{className:"tomato-image",src:S.a,alt:"basic tomato"}),r.a.createElement("h1",{"aria-label":"1",className:"welcome-banner"},e.headerText),e.logButton)},y=(a(40),function(e){Object(m.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).editRating=function(){var e,t;(e=n.props.user.id,t=n.props.userRating.id,fetch("https://rancid-tomatillos.herokuapp.com/api/v2/users/".concat(e,"/ratings/").concat(t),{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({})}).catch((function(e){return console.log(e)}))).then((function(){return n.props.retrieveAllRatings()}))},n.trackRating=function(e){n.setState({inputRating:e.target.value})},n.submitRating=function(){var e,t,a;n.state.inputRating>=1&&n.state.inputRating<=10?(n.setState({error:!1}),(e=n.props.user.id,t=n.props.id,a=n.state.inputRating,fetch("https://rancid-tomatillos.herokuapp.com/api/v2/users/".concat(e,"/ratings"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({movie_id:t,rating:parseInt(a)})}).then((function(e){return e.json()})).catch((function(e){return console.log(e)}))).then((function(){return n.props.retrieveAllRatings()}))):n.setState({error:!0})},n.determineIfLink=function(e){return n.props.user.name?r.a.createElement(o.b,{to:e},r.a.createElement("img",{className:"movie-card-image",alt:"single movie card for {this.props.title}",src:n.props.posterPath})):r.a.createElement("img",{className:"movie-card-image",alt:"single movie card for {this.props.title}",src:n.props.posterPath})},n.determineRatingContent=function(){return n.props.user.name&&!n.props.userRating?r.a.createElement(r.a.Fragment,null,r.a.createElement("label",{htmlFor:"Rate Movie"},"Rate Movie: "),r.a.createElement("input",{onChange:n.trackRating,role:"spinbutton",tabIndex:"0",type:"number",min:"1",max:"10",className:"user-rating-input",placeholder:"rate me"}),r.a.createElement("br",null),r.a.createElement("button",{onClick:n.submitRating,className:"submit-rating-button"},"Submit"),r.a.createElement("br",null),n.state.error&&r.a.createElement("p",null,"Choose a number between 1 and 10")):n.props.user.name&&n.props.userRating?r.a.createElement(r.a.Fragment,null,r.a.createElement("p",{className:"movie-user-rating"},"My Rating: ",n.props.userRating.rating),r.a.createElement("button",{onClick:n.editRating,className:"edit-user-rating"},"Edit Rating")):void 0},n.state={inputRating:0,error:!1},n}return Object(l.a)(a,[{key:"render",value:function(){var e="/movie/".concat(this.props.id);return r.a.createElement("article",{className:"movie-card"},this.determineIfLink(e),r.a.createElement("h3",{className:"movie-title"},this.props.title),r.a.createElement("p",{className:"movie-average-rating"},"Average Rating: ",Math.floor(this.props.averageRating)),this.determineRatingContent())}}]),a}(n.Component));a(41);var C=function(e){var t=e.allMovies.map((function(t){return r.a.createElement(y,{posterPath:t.poster_path,title:t.title,averageRating:t.average_rating,id:t.id,user:e.user,userRating:e.userRatings.find((function(e){return e.movie_id===t.id})),retrieveAllRatings:e.retrieveAllRatings})}));return e.allMovies?r.a.createElement("section",{className:"all-movie-cards"},t):r.a.createElement("h2",null,"Loading movies!!")},j=(a(42),function(e){Object(m.a)(a,e);var t=Object(p.a)(a);function a(){var e;return Object(c.a)(this,a),(e=t.call(this)).determineHeaderText=function(){return e.state.user.name?"Welcome Back, ".concat(e.state.user.name):"Rancid Tomatillos"},e.logOutUser=function(){e.setState({user:{},hasLoginView:!1})},e.updateLoginView=function(){e.state.user.name||e.setState({hasLoginView:!0})},e.returnGuestToHomepage=function(){e.setState({hasLoginView:!1})},e.determineLogButtonStatus=function(){return e.state.user.name?r.a.createElement(o.b,{to:"/"},r.a.createElement("button",{className:"log-button",onClick:e.logOutUser},"Logout")):e.state.hasLoginView?r.a.createElement(o.b,{to:"/"},r.a.createElement("button",{className:"log-button",onClick:e.returnGuestToHomepage},"Back to Homepage")):r.a.createElement(o.b,{to:"/login"},r.a.createElement("button",{className:"log-button"},"Login"))},e.findUserRating=function(t){if(e.state.userRatings.length){var a=e.state.userRatings.find((function(e){return e.movie_id===t}));if(a)return a.rating}},e.state={movies:[],error:"",user:{},userRatings:[],hasLoginView:!1},e.setUser=e.setUser.bind(Object(u.a)(e)),e.retrieveAllRatings=e.retrieveAllRatings.bind(Object(u.a)(e)),e}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=this;fetch("https://rancid-tomatillos.herokuapp.com/api/v2/movies").then((function(e){return e.json()})).catch((function(e){console.log("error",e),alert("Oops, no movies to show right now!")})).then((function(t){return e.setState({movies:t.movies})})).catch((function(t){e.setState({error:t})}))}},{key:"setUser",value:function(e){var t=this;this.setState(e),this.state.user.name&&d(this.state.user.id).then((function(e){return t.setState({userRatings:e.ratings})}))}},{key:"retrieveAllRatings",value:function(){var e=this;d(this.state.user.id).then((function(t){e.setState({userRatings:t.ratings})}))}},{key:"render",value:function(){var e=this;return r.a.createElement("main",null,r.a.createElement(k,{headerText:this.determineHeaderText(),logButton:this.determineLogButtonStatus()}),r.a.createElement(h.b,{exact:!0,path:"/"},r.a.createElement(C,{user:this.state.user,allMovies:this.state.movies,userRatings:this.state.userRatings,retrieveAllRatings:this.retrieveAllRatings})),r.a.createElement(h.b,{path:"/movie/:id",render:function(t){var a=t.match.params.id,n=e.state.movies.find((function(e){return e.id===parseInt(a)}));return r.a.createElement(w,Object.assign({},n,{findUserRating:e.findUserRating,retrieveAllRatings:e.retrieveAllRatings,user:e.state.user}))}}),r.a.createElement(h.b,{exact:!0,path:"/login"},r.a.createElement(f,{setUser:this.setUser,user:this.state.user,updateLoginView:this.updateLoginView})))}}]),a}(n.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var O=r.a.createElement(o.a,null,r.a.createElement(j,null));s.a.render(r.a.createElement(r.a.StrictMode,null,O),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[25,1,2]]]);
//# sourceMappingURL=main.feaf13bb.chunk.js.map